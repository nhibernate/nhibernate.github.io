

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head><meta http-equiv="X-UA-Compatible" content="IE=7" /><meta name="robots" content="index,follow" />
<meta name="description" content="The official NHibernate community site. Download NHibernate. Read blogs. Contribute to the NHibernate Wiki. Find reference documentation." />
<meta name="keywords" content="NHibernate, NHibernate Contrib, community, Burrow, Downloads" />
<meta name="GENERATOR" content="CommunityServer 2008.5 SP1 (Build: 31106.3070)" />
<link rel="shortcut icon" type="image/ico" href="../../favicon.ico" />
<link rel="alternate" type="application/rss+xml" title="Introduction (RSS 2.0)" href="introduction/rss.aspx"  />
<link rel="alternate" type="application/rss+xml" title="Burrow (RSS 2.0)" href="http://nhforge.org/wikis/burrow/rss.aspx"  />
<link rel="alternate" type="application/rss+xml" title="Marc Climent&#39;s Announcements (RSS 2.0)" href="../../members/climens/announcements/rss.aspx"  />
<link rel="alternate" type="application/rss+xml" title="Marc Climent&#39;s Comments (RSS 2.0)" href="../../members/climens/comments/rss.aspx"  />
<link rel="alternate" type="application/rss+xml" title="Marc Climent&#39;s Activities (RSS 2.0)" href="../../members/climens/activities/rss.aspx"  />
<link rel="alternate" type="application/rss+xml" title="Marc Climent&#39;s Friends Activity (RSS 2.0)" href="../../members/climens/activities/friendrss.aspx"  />

        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <style type="text/css"> body { font-size: 84%; } </style>
        <link rel="stylesheet" href="../../themes/hawaii/style/Common.css" type="text/css" media="screen,print" />
        <link rel="stylesheet" href="../../themes/hawaii/style/common_print.css" type="text/css" media="print" />
        
    
    <link rel="stylesheet" href="../../Themes/hawaii/style/wiki.css" type="text/css" media="screen,print" />
	

        <link rel="stylesheet" href="../../themes/hawaii/style/DynamicStyle.aspx.css" type="text/css" media="screen" />
        <!--[if lte IE 6]>
            <link rel="stylesheet" href="/themes/hawaii/style/ie6.css" type="text/css" media="screen" />
        <![endif]-->
    <meta name="google-site-verification" content="u9qihpHbzSFdf2ypCUvCQrj9IJkANGzorC8zMk0859M" />
<title>
	Introduction - NHibernate Forge
</title></head>
	<body>
		<form name="aspnetForm" method="post" action="introduction.aspx.html" id="aspnetForm">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwULLTE0MjI1NzA4NTBkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYBBTBjdGwwMCRjdGwwMCRzciRzciRjdGwwMCRjdGwwMCRUaXRsZUJhclNlYXJjaFRleHRnkoeGkMFUl/GCfp0jWEl0wBWF5g==" />
</div>


<script src="../../WebResource.axd%3Fd=0gbcOAOlbWsHyCtP1tLKZQbpxrEkhg31E8L04T1x-hMLrsMonvmUNQvxBohSywWHueFgWT841lW9e5k7Gp2DbPsOLeN3Sv3SB7czfVSlQGxYOHnJcLlKfh3v9vlcjJ9ggvps0fjahw73J3SVYQmGvS0rXng1&amp;t=634395149500000000" type="text/javascript"></script>
<script src="../../WebResource.axd%3Fd=qXX_qxw7Y60qjc1NsxHnuIWUCy9JxjEUKLrY5KEQyuYhKzv3UmRPH805gTXU5edfSsLl7PHTIDuZbzGOp5UYEWeQ6anyqFa-m5TiNnZiD5MOrgiKWAZBgPyJ267gdCbk0_TpK2BaAhLvEgyM28dt9SYQ2UM1&amp;t=634395149500000000" type="text/javascript"></script>
<script src="../../WebResource.axd%3Fd=c5kkseX-7hUDg441H_iVoy5ws7YKvwS4KliHEKHuRl5UdJkUU5Jbdf2sxzCcbfyn6sqe17DzqhSTfAyV8nyJKMHhScl2IzjSz37RVYryN9Omis3K0NCj_OJ4fHZH3n9_IPBlNLVyYL45kjJL_zhydrkKTi3FfxaImDeS_1JZIO7o9iFs0&amp;t=634395149500000000" type="text/javascript"></script>
<script src="../../WebResource.axd%3Fd=kMYUTUavSIm2PfhqImV65wSrGgvlXLz6y2I9w1Ny3wgQ9Mr8YxqHob4FEFjJCAuSefb7UiiHarHcIuJD4xiKEgAWZ6bkGuLRZKuFDCHjRSswzwvX2HIxCYe1LS8DvrUxi4omY-uxichRl_7QG7gvnymf7ji60ufX0GdWKCPuYuKcXuCoaDwpH8N3g3tlQpPEgpisGg2&amp;t=634395149480000000" type="text/javascript"></script>
<script src="../../WebResource.axd%3Fd=ooIwVX8behGAEmhMCiixHbDdkMUOVYaZRdlMT8IcoNg04bCvP2nwsB6TYoQ7d2Jv_3l4oJ1T22OjM-M-2DunSYiieujBrutwDXLnAl2vCYvC2eq5i-t1eW9X33MvMiQlvp4qyu1-rLPWkjuV_LZnUetgmSNTxQbJe-EddFxbtbp-DYr30&amp;t=634395149500000000" type="text/javascript"></script>
<script src="../../WebResource.axd%3Fd=xXlM6p6Z55_L0aHC_AFQRK0Cjmpbijxk7GNNsmfNwwA1waqkaV-hG1FcycUhTX3miKHBKKxRY86jAc_xya2ioQnh8uEZNMdbhp5EeN7LrycYZRTwA1RkyBpeEDeC_6M7Ye32k1z4nBfateiS4xaRnrrk7zAUyXGK9sqQp9FDULq-nwZx0&amp;t=634395149500000000" type="text/javascript"></script>
						

			

		    
		        <div id="CommonHeader">
		            <div class="Common">
		                <div id="CommonHeaderTitleArea">
		                    <table cellpadding="0" cellspacing="0" border="0"><tr valign="middle">
		                        <td><div style="margin-right: 10px;"><img src="../../cfs-file_ashx/__key/CommunityServer.Components.SiteFiles/logos/LogoNH.gif" alt="" style="border-width:0px;" /></div></td>
		                        <td>
		                            <div class="CommonHeaderTitle">NHibernate Forge</div>
		                            <div class="CommonHeaderTitleDescription">The official new home for the NHibernate for .NET community</div>
		                        </td>
		                    </tr></table>
		                </div>
		                <div id="CommonHeaderUserArea">
		                    <table cellpadding="0" cellspacing="0" border="0"><tr valign="top"><td>
                                <div id="CommonHeaderUserContent">
                                    <div id="CommonHeaderUserWelcome">
                                        
        <a href="../../login.aspx%3FReturnUrl=%252Fwikis%252Fburrow%252Fintroduction.aspx.html">Sign in </a>
         | <a href="../../user/CreateUser.aspx%3FReturnUrl=.html">Join</a>
        | <a href="http://dev.communityserver.com/r.ashx?K&amp;siteurl=wikis.wiki_Page_View">Help</a>
     


                                    </div>
                                </div>
                            </td></tr></table>
                        </div>
                    </div>
                </div>
                <div id="CommonNavigation">
                    <div class="Common"><div class="Inner">
                        <ul>
                                
                                <li><a href="../../index.html">Home</a></li>
                            
                                
                                <li><a href="../../blogs/nhibernate.html">Blog</a></li>
                            
                                <li><a class="Selected" href="../index.html">Wikis</a></li>
                                
                            
                                
                                <li><a href="../../groups/index.html">Groups</a></li>
                            
                                
                                <li><a href="../../doc/nh/en/index.html">Reference</a></li>
                            
                                
                                <li><a href="http://nhibernate.jira.com">Issue tracker</a></li>
                            
                                
                                <li><a href="https://github.com/nhibernate/nhibernate-core">Source Code</a></li>
                            </ul>
                        <div style="clear: both;"></div>
                     </div></div>
                </div>
                
                        <div id="CommonNavigation2">
                            <div class="Common"><div class="Inner">
                                <ul>
                    
                        
                        <li><a href="../general/default.aspx.html">General</a></li>
                    
                        
                        <li><a href="../howtonh/default.aspx.html">How to</a></li>
                    
                        
                        <li><a href="../patternsandpractices/default.aspx.html">Patterns&Practices</a></li>
                    
                                </ul>
                            </div></div>
                        </div>
                    
                <div id="CommonNavigationShadow">
                    
    
    <div class="CommonBreadCrumbArea"><div class="Common">
        <a href="../index.html">Wikis</a>
        &raquo;
        <a href="default.aspx.html">Burrow</a>
        &raquo;
        <a href="introduction.aspx.html">Introduction</a>
    </div></div>


                </div>
		    
                        
            <div class="Common">
            
                
            
                <div id="CommonSearch">
                    
    
        
                <div class="CommonSearchArea">
                    <div class="CommonSearchRoundTop"><div class="r1"></div><div class="r2"></div><div class="r3"></div><div class="r4"></div></div>
                    <div class="CommonSearchContent"><div class="CommonSearchContentInner">
                        <input name="ctl00$ctl00$sr$sr$ctl00$ctl00$TitleBarSearchText" type="text" maxlength="64" size="15" id="ctl00_ctl00_sr_sr_ctl00_ctl00_TitleBarSearchText" onclick="if(this.defaultValue==this.value) this.value='';" onblur="if(this.value=='') this.value=this.defaultValue;" onkeydown="return KeyDownHandlerctl00_ctl00_sr_sr_ctl00_ctl00_TitleBarSearchButton(event);" /><input type="submit" name="ctl00$ctl00$sr$sr$ctl00$ctl00$TitleBarSearchButton" value="Â " id="ctl00_ctl00_sr_sr_ctl00_ctl00_TitleBarSearchButton" class="CommonSearchButton" />
                    </div></div>
                    <div class="CommonSearchRoundBottom"><div class="r1"></div><div class="r2"></div><div class="r3"></div><div class="r4"></div></div>
                </div>
            
    

                </div>
                <div id="CommonTitle">
                    
    
    <h1 class="CommonTitle">Introduction</h1>


                </div>
                <div style="clear: both;"></div>
			    <div id="CommonSidebarRight">
			        
    
	<div class="CommonSidebar">
	    
	    
	        
	                <div class="CommonContentBox">
                        <h4 class="CommonContentBoxHeader">Shortcuts</h4>
	                    <div class="CommonContentBoxContent">
	            <ul class='CommonSidebarList'><li><a href="default.aspx.html">Home</a></li><li><a href="introduction/rss.aspx">RSS feed for page</a></li></ul>
				        </div>
				        
			        </div>
	            
	    
	        
	    
	        
	                <div class="CommonContentBox">
                        <h4 class="CommonContentBoxHeader">Wiki Page Hierarchy</h4>
	                    <div class="CommonContentBoxContent">
	            <div><ul class="CommonHierarchicalList"><li><a href="home.aspx.html">Home</a></li><li><a href="introduction.aspx.html" class="Selected">Introduction</a></li><li><a href="get-started.aspx.html"> Get Started</a></li><li><a href="conversation-explained.aspx.html">Conversation Explained</a></li><li><a href="stateful-fields.aspx.html">Stateful Fields</a></li><li><a href="faq.aspx.html">FAQ</a></li><li><a href="example.aspx.html">Example</a></li></ul></div>
				        </div>
				        
			        </div>
	            
	    
	        
	                <div class="CommonContentBox">
                        <h4 class="CommonContentBoxHeader">Pages</h4>
	                    <div class="CommonContentBoxContent">
	            <div><ul class="CommonHierarchicalList"><li><a href="home.aspx.html">Home</a></li><li><a href="introduction.aspx.html" class="Selected">Introduction</a></li><li><a href="get-started.aspx.html"> Get Started</a></li><li><a href="conversation-explained.aspx.html">Conversation Explained</a></li><li><a href="stateful-fields.aspx.html">Stateful Fields</a></li><li><a href="faq.aspx.html">FAQ</a></li><li><a href="example.aspx.html">Example</a></li></ul></div>
				        </div>
				        
			        </div>
	            
	    
	        
	                <div class="CommonContentBox">
                        <h4 class="CommonContentBoxHeader">Tags</h4>
	                    <div class="CommonContentBoxContent">
	            <ul class="CommonSidebarTagCloud">
<li class="CommonTag6"><a href="tags/equality/default.aspx.html" rel="tag">equality</a></li>
<li class="CommonTag6"><a href="tags/identity/default.aspx.html" rel="tag">identity</a></li>
<li class="CommonTag1"><a href="tags/pattern/default.aspx.html" rel="tag">pattern</a></li>
<li class="CommonTag6"><a href="tags/unit+of+work/default.aspx.html" rel="tag">unit of work</a></li>
</ul>

				        </div>
				        <div class="CommonContentBoxFooter"><a href="tags/default.aspx.html">View more</a></div>
			        </div>
	            
	    
	        
	                <div class="CommonContentBox">
                        <h4 class="CommonContentBoxHeader">Page Details</h4>
	                    <div class="CommonContentBoxContent">
	            <div class="CustomWikiPageDetailsArea"><div class="CustomWikiPageDetailsTitle">First published by:</div><div class="CustomWikiPageDetailsAvatar"><img src="../../utility/anonymous.gif" alt="" style="border-width:0px;max-height:50px;max-width:50px;" /></div><div class="CustomWikiPageDetailsContent"><a href="../../members/kailuowang/default.aspx.html">kailuowang</a><br/> on 09-07-2008</div></div><div class="CustomWikiPageDetailsArea"><div class="CustomWikiPageDetailsTitle">Last revision by:</div><div class="CustomWikiPageDetailsAvatar"><img src="../../utility/anonymous.gif" alt="" style="border-width:0px;max-height:50px;max-width:50px;" /></div><div class="CustomWikiPageDetailsContent"><a href="../../members/climens/default.aspx.html">Marc Climent</a><br/> on 09-12-2008</div></div><div class="WikiPageDetailsSummaryArea"><strong>2</strong> people found this article useful.</div>
				        </div>
				        
			        </div>
	            
	    
	    
	    
    </div>
    

			    </div>
                <div id="CommonSidebarLeft">
				    
				</div>
			    <div id="CommonContent"><div id="CommonContentInner">
    



<div class="CommonContentBox">
    <div class="CommonContentBoxContent">
        <div style="float: right">
            
        </div>
        
        <div class="CommonPaneTabSet">
            <div style="overflow: hidden;">
                <table border="0" cellpadding="0" cellspacing="0">
                <tbody>
                    <tr>
                        <td>
                            <div class="CommonPaneTabSelected">
                                <img align="absmiddle" border="0" src="../../Themes/hawaii/images/wiki/wiki-icon-article-tab.png" alt="" style="border-width:0px;" /> Article
                            </div>
                        </td>
                        
                                
                                                            
                        <td>
                            <div class="CommonPaneTab">
                                <a href="introduction/comments.aspx.html"><img align="absmiddle" border="0" src="../../Themes/hawaii/images/wiki/wiki-icon-comment-tab.png" alt="" style="border-width:0px;" /></a>
                                <a href="introduction/comments.aspx.html">Comments</a> (2)
                            </div>
                        </td>
                        <td>
                            <div class="CommonPaneTab">
                                <a href="introduction/history.aspx.html"><img align="absmiddle" border="0" src="../../Themes/hawaii/images/wiki/wiki-icon-history-tab.png" alt="" style="border-width:0px;" /></a>
                                <a href="introduction/history.aspx.html">History</a> (8)
                            </div>
                        </td>
                    </tr>
                </tbody>
                </table>
            </div>
        </div>

        <div class="CommonPane">
            <div class="CommonGroupedContentArea">                

                <div id="ctl00_ctl00_bcr_bcr_ctl08" class="WikiRating" title="Rated: 2 Ratings - 2 Yes, 0 No" ><div><img src="../../utility/images/thumbsup.png" id="ctl00_ctl00_bcr_bcr_ctl08_image" alt="" /><span id="ctl00_ctl00_bcr_bcr_ctl08_percent" class="WikiRatingGood">100%</span> <span id="ctl00_ctl00_bcr_bcr_ctl08_percenttext">of people found this useful</span></div></div>

                <h2 class="CommonContentBoxHeaderSmall">
                        <span><a href="introduction.aspx.html">Introduction</a></span>
                        
                    </h2>
                                
                <div class="CommonDescription" style="font-size: 90%;">
                    <span id="ctl00_ctl00_bcr_bcr_ctl09_ctl01"></span><input type="hidden" name="ctl00$ctl00$bcr$bcr$ctl09$ctl01" id="ctl00_ctl00_bcr_bcr_ctl09_ctl01_State" value="nochange" /> <a onclick="ctl00_ctl00_bcr_bcr_ctl09_ctl01.Edit(new Function('tags','successFunction','failureFunction','WebForm_DoCallback(\'ctl00$ctl00$bcr$bcr$ctl09\',\'saveAndFormat:\' + tags,successFunction,tags,failureFunction,false)'));return false;" href="introduction.aspx.html#">[Edit Tags]</a>
                </div>
                <div><h4><b>Why Is Burrow Needed?</b></h4>
<p>Burrow is a light weight middleware developed to support .Net applications using NHibernate (maybe also referred as NH in this article) as ORM framework.<br />Using Asp.net with NHibernate could be a challenge because of the fact that NHibernate is a stateful environment while Asp.net is a stateless framework. Burrow can help solve this conflict by providing advanced and smart session/transaction management and other facilitates.<br />The core concept of Burrow is <a class="ExistingPageLink" href="conversation-explained.aspx.html" title="Click to view the page titled: Burrow Conversation">Burrow Conversation</a>, which was inspired by the Conversation concept in <a href="http://www.jboss.com/products/seam">JBoss Seam </a>. Conversation is designed to represent a stateful business conversation between end-user and system. Burrow manages NH session around conversation - it opens a session at the beginning of each conversation, and then close the session at the end of the conversation.<br />For business transactions that can be taken care of in one http request response round trip, for example, modifying the customer information, Burrow takes care of the conversation transparently, which means that your code does not need to be aware of Burrow conversation. By default, Burrow framework starts a conversation at the beginning of a request and commit/close it at the end of the request. In terms of NH session management, it can be deemed as an implementation of the OpenSessionInView pattern, that is, one NHibernate session and one transaction per http request.<br />OpenSessionInView pattern isn&#39;t hard to implement, but the real power Burrow provides is that Burrow conversation can span over multiple http requests, in another sentence, Burrow Conversation allows end user to have a stateful business conversation with the system that spans over multiple http request and response. For example the checkout process is a typical business transaction that can span over multiple request/response dialogues - user needs to enter shipping information, billing information and confirm the order information. Through conversation, Burrow can also make sure that such long business transaction is atomic and isolated by applying atomic transaction strategy. More importantly, like in Seam, one user can have multiple Burrow conversations with the system simultaneously.<br />For more information about Burrow Conversation, <a class="ExistingPageLink" href="conversation-explained.aspx.html" title="Click to view the page titled: Burrow Conversation">click here</a>. 
</p>
<h4>Main Features of Burrow</h4>
<ul>
<li><b>Burrow Conversation</b> with which you can easily write business transaction 
</li>
<li><b>GenericDAO</b> with which ISession can be seldom touched most of the time 
</li>
<li><b>Stateful field attributes</b> with which marked fields of Asp.net UserControl and Page will be stateful over multiple http requests. It helps UserControls or Pages remember entity without causing lazy load exception. 
</li>
<li><b>Multiple databases support</b>. multiple databases becomes easy, you don&#39;t need a SessionFactoryPath, you simply give Burrow an entity type, and Burrow will find the right ISession for you. If you are using GenericDAO, the multiple DB support can be very transparent - your code does not need to know there are multiple databases. </li>
</ul>
<h4><b>A Simple Example about Long Conversation</b></h4>
<p>To demonstrate Burrow, we used the basic example from the well-known article &quot;<a href="http://www.codeproject.com/KB/architecture/NHibernateBestPractices.aspx%20">NHibernate Best Practices with ASP.NET</a>&quot; from CodeProject.com. We have two versions of modifications of it: 
</p>
<ul>
<li>BasicCore example - it only uses the core Burrow function - session management. This example can be found in NHContribRoot\Examples\NHBestPracticesWAspNet\BasicSampleWithBurrowCore 
</li>
<li>BasicAppBlock example - it uses not only the core part but also some other optional classes from Burrow.WebUtil and Burrow.AppBlock to significantly simplify code . This example can be found in NHContribRoot\Examples\NHBestPracticesWAspNet\BasicSampleWithBurrowAppBlock </li>
</ul>
<p><br />Most of the code in BasicCore example is the same as the original basic sample to demonstrate that Burrow can be used with any design and architecture. We added a PlaceOrder.aspx to demonstrate what Burrow can enable - business transaction that spans over multiple requests. This page is like a checkout page, but tweaked for demo purpose. The steps are simple as the point here is to demonstrate the multiple steps.<br /><b>PlaceOrder.aspx</b></p>
<div style="border:1px solid gray;margin:20px 0px 10px;padding:4px;overflow:auto;font-size:8pt;width:97.5%;cursor:text;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;height:368px;background-color:#f4f4f4;max-height:200px;">
<div style="border-style:none;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;">
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;"><span style="color:#0000ff;">&lt;</span><span style="color:#800000;">asp:PlaceHolder</span> <span style="color:#ff0000;">ID</span><span style="color:#0000ff;">=&quot;phSelectCustomer&quot;</span> <span style="color:#ff0000;">runat</span><span style="color:#0000ff;">=&quot;server&quot;</span> <span style="color:#ff0000;">Visible</span><span style="color:#0000ff;">=&quot;true&quot;</span><span style="color:#0000ff;">&gt;</span></pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;">    Select a customer who wants to place an order (will be the OrderBy)<span style="color:#0000ff;">&lt;</span><span style="color:#800000;">br</span> <span style="color:#0000ff;">/&gt;</span></pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;">    <span style="color:#0000ff;">&lt;</span><span style="color:#800000;">asp:DropDownList</span> <span style="color:#ff0000;">ID</span><span style="color:#0000ff;">=&quot;ddlCustomers&quot;</span> <span style="color:#ff0000;">runat</span><span style="color:#0000ff;">=&quot;server&quot;</span> <span style="color:#ff0000;">DataTextField</span><span style="color:#0000ff;">=&quot;ContactName&quot;</span> <span style="color:#ff0000;">DataValueField</span><span style="color:#0000ff;">=&quot;ID&quot;</span><span style="color:#0000ff;">&gt;</span></pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;">    <span style="color:#0000ff;">&lt;/</span><span style="color:#800000;">asp:DropDownList</span><span style="color:#0000ff;">&gt;</span></pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;">    <span style="color:#0000ff;">&lt;</span><span style="color:#800000;">asp:Button</span> <span style="color:#ff0000;">ID</span><span style="color:#0000ff;">=&quot;btnSelectCustomer&quot;</span> <span style="color:#ff0000;">runat</span><span style="color:#0000ff;">=&quot;server&quot;</span> <span style="color:#ff0000;">Text</span><span style="color:#0000ff;">=&quot;Next&quot;</span> <span style="color:#ff0000;">OnClick</span><span style="color:#0000ff;">=&quot;Step1&quot;</span> <span style="color:#0000ff;">/&gt;</span></pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;"><span style="color:#0000ff;">&lt;/</span><span style="color:#800000;">asp:PlaceHolder</span><span style="color:#0000ff;">&gt;</span></pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;"><span style="color:#0000ff;">&lt;</span><span style="color:#800000;">asp:PlaceHolder</span> <span style="color:#ff0000;">ID</span><span style="color:#0000ff;">=&quot;phEnterShipToName&quot;</span> <span style="color:#ff0000;">runat</span><span style="color:#0000ff;">=&quot;server&quot;</span> <span style="color:#ff0000;">Visible</span><span style="color:#0000ff;">=&quot;false&quot;</span><span style="color:#0000ff;">&gt;</span></pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;">    Please enter your ship to information:</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;">    <span style="color:#0000ff;">&lt;</span><span style="color:#800000;">asp:TextBox</span> <span style="color:#ff0000;">ID</span><span style="color:#0000ff;">=&quot;tbShipToName&quot;</span> <span style="color:#ff0000;">runat</span><span style="color:#0000ff;">=&quot;server&quot;</span><span style="color:#0000ff;">&gt;&lt;/</span><span style="color:#800000;">asp:TextBox</span><span style="color:#0000ff;">&gt;</span></pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;">    <span style="color:#0000ff;">&lt;</span><span style="color:#800000;">asp:Button</span> <span style="color:#ff0000;">ID</span><span style="color:#0000ff;">=&quot;btnEnterShipTo&quot;</span> <span style="color:#ff0000;">runat</span><span style="color:#0000ff;">=&quot;server&quot;</span> <span style="color:#ff0000;">Text</span><span style="color:#0000ff;">=&quot;Next&quot;</span> <span style="color:#ff0000;">OnClick</span><span style="color:#0000ff;">=&quot;btnStep2&quot;</span> <span style="color:#0000ff;">/&gt;&lt;</span><span style="color:#800000;">br</span> <span style="color:#0000ff;">/&gt;</span></pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;">    <span style="color:#0000ff;">&lt;</span><span style="color:#800000;">asp:Button</span> <span style="color:#ff0000;">ID</span><span style="color:#0000ff;">=&quot;btnCancel&quot;</span> <span style="color:#ff0000;">OnClick</span><span style="color:#0000ff;">=&quot;Cancel&quot;</span> <span style="color:#ff0000;">runat</span><span style="color:#0000ff;">=&quot;server&quot;</span> <span style="color:#ff0000;">Text</span><span style="color:#0000ff;">=&quot;cancel&quot;</span><span style="color:#0000ff;">&gt;&lt;/</span><span style="color:#800000;">asp:Button</span><span style="color:#0000ff;">&gt;</span></pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;"><span style="color:#0000ff;">&lt;/</span><span style="color:#800000;">asp:PlaceHolder</span><span style="color:#0000ff;">&gt;</span></pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;"><span style="color:#0000ff;">&lt;</span><span style="color:#800000;">asp:PlaceHolder</span> <span style="color:#ff0000;">ID</span><span style="color:#0000ff;">=&quot;phConfirm&quot;</span> <span style="color:#ff0000;">runat</span><span style="color:#0000ff;">=&quot;server&quot;</span> <span style="color:#ff0000;">Visible</span><span style="color:#0000ff;">=&quot;false&quot;</span><span style="color:#0000ff;">&gt;</span>Customer:</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;">    <span style="color:#0000ff;">&lt;</span><span style="color:#800000;">asp:Literal</span> <span style="color:#ff0000;">ID</span><span style="color:#0000ff;">=&quot;lCustomer&quot;</span> <span style="color:#ff0000;">runat</span><span style="color:#0000ff;">=&quot;server&quot;</span><span style="color:#0000ff;">&gt;&lt;/</span><span style="color:#800000;">asp:Literal</span><span style="color:#0000ff;">&gt;</span></pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;">    <span style="color:#0000ff;">&lt;</span><span style="color:#800000;">br</span> <span style="color:#0000ff;">/&gt;</span></pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;">    Ship to:</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;">    <span style="color:#0000ff;">&lt;</span><span style="color:#800000;">asp:Literal</span> <span style="color:#ff0000;">ID</span><span style="color:#0000ff;">=&quot;lShipTo&quot;</span> <span style="color:#ff0000;">runat</span><span style="color:#0000ff;">=&quot;server&quot;</span><span style="color:#0000ff;">&gt;&lt;/</span><span style="color:#800000;">asp:Literal</span><span style="color:#0000ff;">&gt;</span></pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;">    <span style="color:#0000ff;">&lt;</span><span style="color:#800000;">br</span> <span style="color:#0000ff;">/&gt;</span></pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;">    <span style="color:#0000ff;">&lt;</span><span style="color:#800000;">asp:Button</span> <span style="color:#ff0000;">ID</span><span style="color:#0000ff;">=&quot;btnConfirm&quot;</span> <span style="color:#ff0000;">runat</span><span style="color:#0000ff;">=&quot;server&quot;</span> <span style="color:#ff0000;">Text</span><span style="color:#0000ff;">=&quot;Confirm&quot;</span> <span style="color:#ff0000;">OnClick</span><span style="color:#0000ff;">=&quot;Finish&quot;</span> <span style="color:#0000ff;">/&gt;</span></pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;"><span style="color:#0000ff;">&lt;/</span><span style="color:#800000;">asp:PlaceHolder</span><span style="color:#0000ff;">&gt;</span></pre>
</div>
</div>
<p><br /><b>PlaceOrder.aspx.cs</b></p>
<div style="border:1px solid gray;margin:20px 0px 10px;padding:4px;overflow:auto;font-size:8pt;width:97.5%;cursor:text;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;height:923px;background-color:#f4f4f4;max-height:200px;">
<div style="border-style:none;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;">
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;"><span style="color:#606060;">   1:</span> <span style="color:#0000ff;">public</span> <span style="color:#0000ff;">partial</span> <span style="color:#0000ff;">class</span> PlaceOrder : Page {</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;"><span style="color:#606060;">   2:</span>     <span style="color:#0000ff;">private</span> IDaoFactory daoFactory = <span style="color:#0000ff;">new</span> NHibernateDaoFactory();</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;"><span style="color:#606060;">   3:</span>     <span style="color:#0000ff;">private</span> BurrowFramework bf = <span style="color:#0000ff;">new</span> BurrowFramework();</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;"><span style="color:#606060;">   4:</span>  </pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;"><span style="color:#606060;">   5:</span>     <span style="color:#008000;">/// &lt;summary&gt;</span></pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;"><span style="color:#606060;">   6:</span>     <span style="color:#008000;">/// Store the placing order in the Conversation.Items so that it has the same life span as the Conversation</span></pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;"><span style="color:#606060;">   7:</span>     <span style="color:#008000;">/// &lt;/summary&gt;</span></pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;"><span style="color:#606060;">   8:</span>     <span style="color:#0000ff;">public</span> Order placingOrder {</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;"><span style="color:#606060;">   9:</span>         get { <span style="color:#0000ff;">return</span> (Order) bf.CurrentConversation.Items[<span style="color:#006080;">&quot;placingOrder&quot;</span>]; }</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;"><span style="color:#606060;">  10:</span>         set { bf.CurrentConversation.Items[<span style="color:#006080;">&quot;placingOrder&quot;</span>] = <span style="color:#0000ff;">value</span>; }</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;"><span style="color:#606060;">  11:</span>     }</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;"><span style="color:#606060;">  12:</span>  </pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;"><span style="color:#606060;">  13:</span>     <span style="color:#0000ff;">protected</span> <span style="color:#0000ff;">void</span> Page_Load(<span style="color:#0000ff;">object</span> sender, EventArgs e) {</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;"><span style="color:#606060;">  14:</span>         <span style="color:#0000ff;">if</span> (!IsPostBack) {</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;"><span style="color:#606060;">  15:</span>             ddlCustomers.DataSource = daoFactory.GetCustomerDao().GetAll();</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;"><span style="color:#606060;">  16:</span>             ddlCustomers.DataBind();</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;"><span style="color:#606060;">  17:</span>         }</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;"><span style="color:#606060;">  18:</span>     }</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;"><span style="color:#606060;">  19:</span>  </pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;"><span style="color:#606060;">  20:</span>     <span style="color:#0000ff;">protected</span> <span style="color:#0000ff;">void</span> Step1(<span style="color:#0000ff;">object</span> sender, EventArgs e) {</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;"><span style="color:#606060;">  21:</span>         <span style="color:#008000;">//start an atomic Conversation that span over postbacks</span></pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;"><span style="color:#606060;">  22:</span>         bf.CurrentConversation.SpanWithPostBacks(TransactionStrategy.BusinessTransaction);</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;"><span style="color:#606060;">  23:</span>         Customer selectedCustomer = daoFactory.GetCustomerDao().GetById(ddlCustomers.SelectedValue, <span style="color:#0000ff;">false</span>);</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;"><span style="color:#606060;">  24:</span>         placingOrder =  <span style="color:#0000ff;">new</span> Order(selectedCustomer) ;</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;"><span style="color:#606060;">  25:</span>         phSelectCustomer.Visible = <span style="color:#0000ff;">false</span>;</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;"><span style="color:#606060;">  26:</span>         phEnterShipToName.Visible = <span style="color:#0000ff;">true</span>;</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;"><span style="color:#606060;">  27:</span>     }</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;"><span style="color:#606060;">  28:</span>  </pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;"><span style="color:#606060;">  29:</span>     <span style="color:#0000ff;">protected</span> <span style="color:#0000ff;">void</span> btnStep2(<span style="color:#0000ff;">object</span> sender, EventArgs e) {</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;"><span style="color:#606060;">  30:</span>         placingOrder.ShipToName = tbShipToName.Text;</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;"><span style="color:#606060;">  31:</span>         phEnterShipToName.Visible = <span style="color:#0000ff;">false</span>;</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;"><span style="color:#606060;">  32:</span>         phConfirm.Visible = <span style="color:#0000ff;">true</span>;</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;"><span style="color:#606060;">  33:</span>         lCustomer.Text = placingOrder.OrderedBy.ToString();</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;"><span style="color:#606060;">  34:</span>         lShipTo.Text = placingOrder.ShipToName;</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;"><span style="color:#606060;">  35:</span>     }</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;"><span style="color:#606060;">  36:</span>  </pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;"><span style="color:#606060;">  37:</span>     <span style="color:#0000ff;">protected</span> <span style="color:#0000ff;">void</span> Cancel(<span style="color:#0000ff;">object</span> sender, EventArgs e) {</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;"><span style="color:#606060;">  38:</span>         bf.CurrentConversation.GiveUp(); <span style="color:#008000;">// give up the current spanning conversation</span></pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;"><span style="color:#606060;">  39:</span>         phEnterShipToName.Visible = <span style="color:#0000ff;">false</span>;</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;"><span style="color:#606060;">  40:</span>         StartOver();</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;"><span style="color:#606060;">  41:</span>     }</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;"><span style="color:#606060;">  42:</span>  </pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;"><span style="color:#606060;">  43:</span>     <span style="color:#0000ff;">private</span> <span style="color:#0000ff;">void</span> StartOver() {</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;"><span style="color:#606060;">  44:</span>         phSelectCustomer.Visible = <span style="color:#0000ff;">true</span>;</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;"><span style="color:#606060;">  45:</span>     }</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;"><span style="color:#606060;">  46:</span>  </pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;"><span style="color:#606060;">  47:</span>     <span style="color:#0000ff;">protected</span> <span style="color:#0000ff;">void</span> Finish(<span style="color:#0000ff;">object</span> sender, EventArgs e) {</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;"><span style="color:#606060;">  48:</span>         placingOrder.OrderDate = DateTime.Now;</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;"><span style="color:#606060;">  49:</span>         daoFactory.GetOrderDao().Save(placingOrder);</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;"><span style="color:#606060;">  50:</span>         bf.CurrentConversation.FinishSpan(); <span style="color:#008000;">//finish up the current spanning conversation</span></pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;"><span style="color:#606060;">  51:</span>         placingOrder = <span style="color:#0000ff;">null</span>; <span style="color:#008000;">//reset the placing order to null after conversation is done is a good practice</span></pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;"><span style="color:#606060;">  52:</span>         phConfirm.Visible = <span style="color:#0000ff;">false</span>;</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;"><span style="color:#606060;">  53:</span>         StartOver();</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:#f4f4f4;"><span style="color:#606060;">  54:</span>     }</pre>
<pre style="border-style:none;margin:0em;padding:0px;overflow:visible;font-size:8pt;width:100%;color:black;line-height:12pt;font-family:consolas,&#39;Courier New&#39;,courier,monospace;background-color:white;"><span style="color:#606060;">  55:</span> }</pre>
</div>
</div>
<pre> </pre>
<p><br />In step 1, &quot;bf.CurrentConversation.SpanWithPostBacks();&quot; is the line to let the system know that the current conversation needs to span after the end of the current request. Without this line, the current conversation will closed at the end of the request (as in OpenSessionPerView mode). Then the code created an order entity and store it into the bf.CurrentConversation.Items[&quot;placingOrder&quot;]. IConversation.Items is a data container through which you can store the data into the current conversation so that the data will have the same life cycle as the conversation. Step2 simple modifies the shipToName property of the placingOrder. The finish step finally persists the order and calls bf.CurrentConversation.FinishSpan(); then Burrow will commit and close this multi-request conversation at the end of this request.<br />For more information about NHibernate.Burrow, here is a guide to the pages of this wiki site:<br /><b><a href="http://nhcontrib.wiki.sourceforge.net/BurrowGetStarted"></a><a class="ExistingPageLink" href="get-started.aspx.html" title="Click to view the page titled: Get Started">Get Started</a></b> - tells how to setup the Burrow framework.<br /><b><a href="http://nhcontrib.wiki.sourceforge.net/BurrowConversationExplained"></a><a class="ExistingPageLink" href="conversation-explained.aspx.html" title="Click to view the page titled: Burrow Conversation Explained">Burrow Conversation Explained</a> -</b> gives more detail in long conversation.<br /><b><a href="http://nhcontrib.wiki.sourceforge.net/BurrowStatefulFields"></a><a class="ExistingPageLink" href="stateful-fields.aspx.html" title="Click to view the page titled: StatefulField Attributes">StatefulField Attributes</a> -</b> explains how Burrow.WebUtil attributes can simplify states maintenance for ASP.NET controls and pages<br /><b><a href="http://nhcontrib.wiki.sourceforge.net/BurrowFAQ"></a><a class="ExistingPageLink" href="faq.aspx.html" title="Click to view the page titled: FAQ">FAQ</a></b> - you know what it is.</p></div>
            </div>
        
        </div>
    </div>
</div>


<div class="CommonContentBox">
    <div style="float: right;">
        
                <a href="../../login.aspx%3FReturnUrl=%252Fwikis%252Fburrow%252Fintroduction.aspx.html"><img src="../../Themes/hawaii/images/wiki/add-a-new-comment.gif" alt="" style="border-width:0px;" /></a>
            
    </div>
    <h3 class="CommonContentBoxHeader">Recent Comments</h3>
    <div class="CommonContentBoxContent">
        
                <div class="WikiCommentArea">
                    <div class="WikiCommentBubble">
                        <div class="WikiCommentBubbleRoundTop"><div class="r1"></div><div class="r2"></div><div class="r3"></div><div class="r4"></div></div>
                        <div class="WikiCommentContent">
                            <div class="WikiCommentHeaderIcon"><a href="../../members/indictaor23/default.aspx.html">
                                    <img src="../../utility/anonymous.gif" alt="" style="border-width:0px;max-height:32px;max-width:32px;" />
                                </a></div>
                            
                            <div class="WikiCommentHeader">
                                By: 
                                <a href="../../members/indictaor23/default.aspx.html">indictaor23</a>
                                Posted on 
                                12-14-2011 18:37
                                
                            </div>
                            <div style="clear: both;"></div>
                            
                            <div><p>great work on convertion</p>
<p><a &nbsp;target="_new" href="http://www.windows8update.com">http://www.windows8update.com</a></p>
</div>

                            <div style="float: right; font-size: 80%;">
                                
                                
                            </div><div style="clear: both;"></div>
                        </div>
                        <div class="WikiCommentBubbleRoundBottom"><div class="r1"></div><div class="r2"></div><div class="r3"></div><div class="r4"></div></div>
                    </div>
                    <div class="WikiCommentArrow"><div class="r1"></div><div class="r2"></div><div class="r3"></div><div class="r4"></div><div class="r5"></div><div class="r6"></div><div class="r7"></div><div class="r8"></div><div class="r9"></div><div class="r10"></div></div>
                </div>     
            
                <div class="WikiCommentArea">
                    <div class="WikiCommentBubble">
                        <div class="WikiCommentBubbleRoundTop"><div class="r1"></div><div class="r2"></div><div class="r3"></div><div class="r4"></div></div>
                        <div class="WikiCommentContent">
                            <div class="WikiCommentHeaderIcon"><a href="../../members/Banks/default.aspx.html">
                                    <img src="../../utility/anonymous.gif" alt="" style="border-width:0px;max-height:32px;max-width:32px;" />
                                </a></div>
                            
                            <div class="WikiCommentHeader">
                                By: 
                                <a href="../../members/Banks/default.aspx.html">Banks</a>
                                Posted on 
                                01-04-2010 20:28
                                
                            </div>
                            <div style="clear: both;"></div>
                            
                            <div><p>Through conversation, Burrow can also make sure that such long business transaction is atomic and isolated by applying atomic transaction strategy.</p>
</div>

                            <div style="float: right; font-size: 80%;">
                                
                                
                            </div><div style="clear: both;"></div>
                        </div>
                        <div class="WikiCommentBubbleRoundBottom"><div class="r1"></div><div class="r2"></div><div class="r3"></div><div class="r4"></div></div>
                    </div>
                    <div class="WikiCommentArrow"><div class="r1"></div><div class="r2"></div><div class="r3"></div><div class="r4"></div><div class="r5"></div><div class="r6"></div><div class="r7"></div><div class="r8"></div><div class="r9"></div><div class="r10"></div></div>
                </div>     
            
                <a href="introduction/comments.aspx.html">View All</a>
            
    </div>
</div>


</div></div>
			    <div style="clear: both;"></div>
			    
			    
            </div>
                
            <div id="CommonFooter">
                <div class="Common">
                    
                        
                	    
                        

                        
                                <a href="http://communityserver.com/" target="_blank"><img src="../../utility/PoweredByCS_commercial.gif" alt="Powered by Community Server (Commercial Edition), by Telligent Systems " style="border-width:0px;" /></a>
		                    
                		
                    
                 </div>
            </div>
		
<script type="text/javascript">
// <![CDATA[
Telligent_Modal.Configure('/utility/loading.htm',['CommonModal'],['CommonModalTitle'],['CommonModalClose'],['CommonModalContent'],['CommonModalFooter'],['CommonModalResize'],['CommonModalMask'],100,false,true);
// ]]>
</script><script type="text/javascript">
<!--
function KeyDownHandlerctl00_ctl00_sr_sr_ctl00_ctl00_TitleBarSearchButton(event)
{
	if (event.keyCode == 13)
	{
		event.returnValue = false;
		event.cancel = true;
     __doPostBack('ctl00$ctl00$sr$sr$ctl00$ctl00$TitleBarSearchButton','')
   return false;
	}
}

//-->
</script>
<script type="text/javascript">
// <![CDATA[
window.ctl00_ctl00_rcr_rcr_ctl00_ctl02_ctl00_ctl01_ctl01=new WikiPageHierarchy('ctl00_ctl00_rcr_rcr_ctl00_ctl02_ctl00_ctl01_ctl01',new Function('mode','pageId','callback','WebForm_DoCallback(\'ctl00$ctl00$rcr$rcr$ctl00$ctl02$ctl00$ctl01$ctl01\',mode + \':\' + pageId,callback,\"\",null,false)'),'<img src="http://nhforge.org/wikis/burrow/\&quot;/WebResource.axd?d=sNXLzaCqbYO_a-ZjCZB88HF4WT8YRbuRaD2xfyafsCiRqelSVt4GYH9QzNn_EvXM02V5zpjGwsymzmW30OIrbB4EUeqA1XW4oU6sME2qMEcOgSVpfz1_YK7UdKB8bVtbFiuWJt3UljrDk5OnRzQEWKDyXNGX0R6sJsultQeBjufuUDz-0&amp;t=634395149500000000\&quot;" alt=\"+\" style=\"border-width: 0;\" />','<img src="http://nhforge.org/wikis/burrow/\&quot;/WebResource.axd?d=I7Z2L5Ca7ffItUeObf-LA3ykZ3Mbmr-vwfNJv2PfNk2O4alHWIJbJADyKhl0k71mJCpGTePjifKqZQx_Rs64LrGhlEU25qRjlCh8LoYwo2tck8EIbBdQKg5CISopk9hz_6ZbK_GNtBJljwOq57_FBvxYCTM1&amp;t=634395149500000000\&quot;" alt=\"-\" style=\"border-width: 0;\" />','<div>Loading...</div>');
// ]]>
</script><script type="text/javascript">
// <![CDATA[
window.ctl00_ctl00_rcr_rcr_ctl00_ctl03_ctl00_ctl01_ctl01=new WikiPageHierarchy('ctl00_ctl00_rcr_rcr_ctl00_ctl03_ctl00_ctl01_ctl01',new Function('mode','pageId','callback','WebForm_DoCallback(\'ctl00$ctl00$rcr$rcr$ctl00$ctl03$ctl00$ctl01$ctl01\',mode + \':\' + pageId,callback,\"\",null,false)'),'<img src="http://nhforge.org/wikis/burrow/\&quot;/WebResource.axd?d=sNXLzaCqbYO_a-ZjCZB88HF4WT8YRbuRaD2xfyafsCiRqelSVt4GYH9QzNn_EvXM02V5zpjGwsymzmW30OIrbB4EUeqA1XW4oU6sME2qMEcOgSVpfz1_YK7UdKB8bVtbFiuWJt3UljrDk5OnRzQEWKDyXNGX0R6sJsultQeBjufuUDz-0&amp;t=634395149500000000\&quot;" alt=\"+\" style=\"border-width: 0;\" />','<img src="http://nhforge.org/wikis/burrow/\&quot;/WebResource.axd?d=I7Z2L5Ca7ffItUeObf-LA3ykZ3Mbmr-vwfNJv2PfNk2O4alHWIJbJADyKhl0k71mJCpGTePjifKqZQx_Rs64LrGhlEU25qRjlCh8LoYwo2tck8EIbBdQKg5CISopk9hz_6ZbK_GNtBJljwOq57_FBvxYCTM1&amp;t=634395149500000000\&quot;" alt=\"-\" style=\"border-width: 0;\" />','<div>Loading...</div>');
// ]]>
</script><script type="text/javascript">
// <![CDATA[
var ctl00_ctl00_bcr_bcr_ctl08 = new RateableContentYesNoRating('ctl00_ctl00_bcr_bcr_ctl08','ctl00_ctl00_bcr_bcr_ctl08','ctl00_ctl00_bcr_bcr_ctl08_image','ctl00_ctl00_bcr_bcr_ctl08_percent','ctl00_ctl00_bcr_bcr_ctl08_percenttext','ctl00_ctl00_bcr_bcr_ctl08_buttons','ctl00_ctl00_bcr_bcr_ctl08_thanks','WikiRating','WikiRatingActive',new Function('r','s','f','WebForm_DoCallback(\'ctl00$ctl00$bcr$bcr$ctl08\',r,s,r,f,false)'));
// ]]>
</script><script type="text/javascript">
// <![CDATA[
window.ctl00_ctl00_bcr_bcr_ctl09_ctl01 = new Telligent_InlineEditorPanel('ctl00_ctl00_bcr_bcr_ctl09_ctl01','ctl00_ctl00_bcr_bcr_ctl09_ctl01','ctl00_ctl00_bcr_bcr_ctl09_ctl01_State','ctl00_ctl00_bcr_bcr_ctl09_ctl00',false,null,null,null);
// ]]>
</script><script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-5443308-1");
pageTracker._trackPageview();
</script></form>
		
	</body>
</html>
